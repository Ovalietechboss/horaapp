{% extends "base.html" %}
{% block content %}
  <h1>{% if entry %}Éditer une saisie{% else %}Nouvelle saisie{% endif %}</h1>

  <div class="card">
    <form method="post" action="{% if entry %}{{ url_for('entry_update', entry_id=entry.id) }}{% else %}{{ url_for('entry_create') }}{% endif %}">
      <div class="row">
        <div>
          <label>Entreprise</label>
          <select name="company_id" required>
            <option value="">-- choisir --</option>
            {% for c in companies %}
              <option value="{{ c.id }}" {% if entry and entry.company_id == c.id %}selected{% endif %}>
                {{ c.name }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div>
          <label>Projet</label>
          <select name="project_id" required>
            <option value="">-- choisir --</option>
            {% for p in projects %}
              <option value="{{ p.id }}" {% if entry and entry.project_id == p.id %}selected{% endif %}>
                {{ p.company.name }} — {{ p.name }}
              </option>
            {% endfor %}
          </select>
          <div class="muted">Le projet doit correspondre à l’entreprise.</div>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Date</label>
          <input type="date" name="work_date" required value="{% if entry %}{{ entry.work_date }}{% endif %}"/>
        </div>
        <div>
          <label>Heures</label>
          <input type="number" step="0.25" min="0" name="hours" required value="{% if entry %}{{ entry.hours }}{% endif %}" />
          <div class="muted">Ex: 0.5, 1.25, 2, 7.5…</div>
        </div>
      </div>

      <div>
        <label>Description (optionnel)</label>
        <textarea name="description" placeholder="Notes...">{% if entry %}{{ entry.description or "" }}{% endif %}</textarea>
      </div>

      <div style="margin-top:12px;">
        <button class="btn" type="submit">{% if entry %}Enregistrer{% else %}Créer{% endif %}</button>
        <a class="btn" href="{{ url_for('dashboard') }}">Retour</a>
      </div>
    </form>
  </div>
{% endblock %}
